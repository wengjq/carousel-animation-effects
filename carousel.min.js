!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.carousel=e()}(this,function(){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t){return function(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function m(t,e,i){var n=t&&t.style;if(n){if(void 0===i)return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(i=t.currentStyle),void 0===e?i:i[e];e in n||(e="-webkit-".concat(e)),n[e]=i+("string"==typeof i?"":"px")}}function u(t,e,i){m(t,"Webkit".concat(e),i),m(t,"Moz".concat(e),i),m(t,"ms".concat(e),i),m(t,"O".concat(e),i),m(t,e,i)}function o(t,e){return t.removeEventListener("animationend",e,!1),t.removeEventListener("webkitAnimationEnd",e,!1),t.removeEventListener("oAnimationEnd",e,!1),t.removeEventListener("oanimationend",e,!1),t.removeEventListener("msAnimationEnd",e,!1),!0}var s,r,d,l,c,h,f=(r=["animation","MozAnimation","webkitAnimation","msAnimation","OAnimation"],d=["transform","MozTransform","webkitTransform","msTransform","OTransform"],l=["opacity","MozOpacity","webkitOpacity","msOpacity","OOpacity"],c=document.createElement("div"),h={},function(t){if("boolean"==typeof h[t])return h[t];switch(t){case"animation":s=r;break;case"transform":s=d;break;case"opacity":s=l;break;default:s=r}for(var e=0,i=s.length;e<i;e+=1)if(void 0!==c.style[s[e]])return h[t]=!0,h[t];return h[t]=!1,h[t]});function b(t){var e=document.createElement("div");return e.innerHTML=t,e.childNodes[0]}return function(){function s(t,e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),!t||!t.nodeType||1!==t.nodeType)throw new Error("Carousel-animation-effects: `el` must be HTMLElement, and not ".concat({}.toString.call(t)));if(!f())throw new Error("Your browser does not support css3");var i,n,o={autoPlay:!0,currentIndex:0,speed:1500,duration:4e3,effectIndex:1,dots:!0,arrows:!0,prevArrow:"<button></button>",nextArrow:"<button></button>",dotsClass:"carousel-dots"};for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(a in e||(e[a]=o[a]));if(this.el=t,this.options=function(t,e){if(t&&e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}({},e),this.container=t.querySelector(".carousel-wrap"),this.items=this.container.children,this.itemsLen=this.container.children.length,this.itemsLen<2)throw new Error("the number of child nodes must be greater than 1");this.timer=null,this.animating=!1,this.autoPlay=this.options.autoPlay,this.speed=this.options.speed,this.duration=this.options.duration,this.effectIndex=this.options.effectIndex,this.currentIndex=this.options.currentIndex,this.dots=this.options.dots,this.dotsClass=this.options.dotsClass,this.arrows=this.options.arrows,this.prevArrow=this.options.prevArrow,this.nextArrow=this.options.nextArrow,this.oldIndex=-1,this.newIndex=-1,this.itemMaxWidth=(i=t).getBoundingClientRect().width||i.offsetWidth,this.itemMaxHeight=(n=t).getBoundingClientRect().height||n.offsetHeight,this.initEvent(),this.initCarouselDom(),this.initArrowsDom(),this.initDotsDom(),this.initView(),this.initPlay()}var t,e,i;return t=s,(e=[{key:"initEvent",value:function(){this.animating=!1,clearTimeout(this.timer);for(var t=0;t<this.itemsLen;t+=1)o(this.items[t],this.eventAnimationEnd.bind(this))}},{key:"initCarouselDom",value:function(){var t,e=this.effectIndex;m(this.container,"height",this.itemMaxHeight),this.container.classList.add("billboard".concat(e),"billboard");for(var i=0;i<this.itemsLen;i+=1)if((t=this.items[i]).classList.add("billboardItem_".concat(e),"billboardAnim","billboard_item"),m(t,"width","100%"),m(t,"height",this.itemMaxHeight),6===e)u(t,"transformOrigin","50% 50% ".concat(-this.itemMaxWidth/2,"px"));else if(7===e)u(t,"transformOrigin","50% 50% ".concat(-this.itemMaxHeight/2,"px"));else if(9===e||10===e){var n=document.createElement("div");n.classList.add("billboardItem_".concat(this.effectIndex),"billboardItem_".concat(e,"_").concat(i+1),"billboard_item");for(var o=1;o<=3;o+=1){var a=document.createElement("div");a.classList.add("billboardTile_".concat(o),"billboardAnim","billboardTile"),u(a,"animationDuration","".concat(this.speed,"ms")),u(a,"transformOrigin","50% 50% ".concat(8===e?-this.itemMaxWidth/2:-this.itemMaxHeight/2,"px"));var s=t.cloneNode(!0);s.setAttribute("class","billboardImg"),s.removeAttribute("style"),s.children[0].classList.add("billboardImgInner"),a.appendChild(s),n.appendChild(a)}t.parentNode.insertBefore(n,t),t.parentNode.removeChild(t)}else if(12===e||13===e||14===e){var r=document.createElement("div");r.classList.add("billboard_item","billboardItem_".concat(e),"billboardItem_".concat(e,"_").concat(i+1)),m(r,"width","100%"),m(r,"height",this.itemMaxHeight);for(var d=1;d<=4;d+=1){var l=document.createElement("div");l.classList.add("billboardTile","billboardTile_".concat(d));var c=document.createElement("div");c.classList.add("billboardAnim","billboardTileImg"),u(c,"animationDuration","".concat(this.speed,"ms")),l.appendChild(c);var h=t.cloneNode(!0);h.setAttribute("class","billboardImg"),h.removeAttribute("style"),h.children[0].classList.add("billboardImgInner"),c.appendChild(h),r.appendChild(l)}t.parentNode.insertBefore(r,t),t.parentNode.removeChild(t)}9!==e&&10!==e&&12!==e&&13!==e&&14!==e||(this.items=this.container.children,this.itemsLen=this.items.length)}},{key:"initDotsDom",value:function(){var n=this;if(this.dots){var t=document.createDocumentFragment(),o=document.createElement("ul");o.classList.add("".concat(this.dotsClass));for(var e=0;e<this.itemsLen;e+=1){var i=document.createElement("li");i.setAttribute("index",e),this.currentIndex===e?i.classList.add("carousel-active"):i.classList.remove("carousel-active"),o.appendChild(i)}o.addEventListener("click",function(t){for(var e=t.target;e!==o;){if("li"===e.tagName.toLowerCase()){var i=parseInt(e.getAttribute("index"),10);n.goTo(i);break}e=e.parentNode}},!1),t.appendChild(o),this.el.appendChild(t)}}},{key:"initArrowsDom",value:function(){var t,e,i,n=this;if(this.arrows){var o=b(this.prevArrow),a=b(this.nextArrow);o.addEventListener("click",function(){n.prev()},!1),a.addEventListener("click",function(){n.next()},!1),o.classList.add("carousel-arrow","carousel-prev"),a.classList.add("carousel-arrow","carousel-next"),this.el.insertBefore(o,this.container),t=a,e=this.container,(i=e.parentNode).lastChild===e?i.appendChild(t):i.insertBefore(t,e.nextSibling)}}},{key:"updateDotsDom",value:function(){var t=this.el.querySelector(".".concat(this.dotsClass)).children;t[this.oldIndex].classList.remove("carousel-active"),t[this.currentIndex].classList.add("carousel-active")}},{key:"initView",value:function(){for(var t=0;t<this.items.length;t+=1)u(this.items[t],"animationDuration","".concat(this.speed,"ms"));var e,i,n,o=this.items[this.currentIndex];o.classList.add("billboardItem_".concat(this.effectIndex,"_start")),e=this.items,i="display",n="none",a(e).forEach(function(t){m(t,i,n)}),m(o,"display","block")}},{key:"initPlay",value:function(){this.autoPlay&&this.play()}},{key:"play",value:function(){this.animating||(clearTimeout(this.timer),this.timer=setTimeout(this.next.bind(this),this.duration))}},{key:"autoPlay",value:function(){this.autoPlay=!0,this.play()}},{key:"next",value:function(){var t=this.currentIndex+1;t>=this.itemsLen&&(t=0),this.goTo(t,!1)}},{key:"prev",value:function(){var t=this.currentIndex-1;t<0&&(t=this.itemsLen-1),this.goTo(t,!0)}},{key:"stop",value:function(){this.autoPlay&&(this.autoPlay=!1,clearTimeout(this.timer))}},{key:"goTo",value:function(t,e){if(!(t>=this.itemsLen||t<0||t===this.currentIndex||this.animating)){this.newIndex=t,void 0===e&&(e=!(this.newIndex>this.currentIndex));var i,n,o=this.items[this.currentIndex],a=this.items[this.newIndex];if(m(a,"display","block"),11===this.effectIndex){var s=["15% 15%","85% 85%","15% 85%","85% 15%"],r=["billboardItem_11_on_zoomOut","billboardItem_11_on_zoomIn"],d=s[Math.floor(Math.random()*s.length)],l=r[Math.floor(Math.random()*r.length)];a.classList.add(l),a.classList.remove("billboardItem_11_off"),u(a,"transformOrigin",d),o.classList.add("billboardItem_11_off"),o.classList.remove("billboardItem_11_on_zoomIn","billboardItem_11_on_zoomOut","billboardItem_11_start")}else o.classList.remove("billboardItem_".concat(this.effectIndex,"_on"),"billboardItem_".concat(this.effectIndex,"_on_reverse")),o.classList.add("billboardItem_".concat(this.effectIndex,"_off")),a.classList.remove("billboardItem_".concat(this.effectIndex,"_off"),"billboardItem_".concat(this.effectIndex,"_off_reverse")),a.classList.add("billboardItem_".concat(this.effectIndex,"_on")),e&&(o.classList.add("billboardItem_".concat(this.effectIndex,"_off_reverse")),a.classList.add("billboardItem_".concat(this.effectIndex,"_on_reverse")));this.animating=!0,this.oldIndex=this.currentIndex,this.currentIndex=this.newIndex,this.updateDotsDom(),i=a,n=this.eventAnimationEnd.bind(this),i.addEventListener("animationend",n,!1),i.addEventListener("webkitAnimationEnd",n,!1),i.addEventListener("oAnimationEnd",n,!1),i.addEventListener("oanimationend",n,!1),i.addEventListener("msAnimationEnd",n,!1)}}},{key:"eventAnimationEnd",value:function(){var t=this;o(this.items[this.newIndex],this.eventAnimationEnd.bind(this))&&(this.animating=!1,m(this.items[this.oldIndex],"display","none"),this.autoPlay&&(clearTimeout(this.timer),this.timer=setTimeout(function(){t.next()},this.duration)))}}])&&n(t.prototype,e),i&&n(t,i),s}()});